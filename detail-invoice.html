<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manajemen Pengguna - PACIFI PRO</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #1B1F3B;
      --secondary-color: #8B0000;
      --accent-color: #4285f4;
      --light-color: #f8f9fa;
      --border-color: #e0e0e0;
      --text-color: #333;
      --success-color: #34a853;
      --danger-color: #ea4335;
      --warning-color: #fbbc05;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa;
      padding: 20px;
      margin: 0;
      color: var(--text-color);
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }
    
    h2 {
      color: var(--primary-color);
      font-size: 24px;
      font-weight: 700;
    }
    
    .breadcrumb {
      display: flex;
      align-items: center;
      font-size: 14px;
      color: #666;
    }
    
    .breadcrumb a {
      color: var(--accent-color);
      text-decoration: none;
    }
    
    .breadcrumb a:hover {
      text-decoration: underline;
    }
    
    .breadcrumb i {
      margin: 0 8px;
      font-size: 12px;
    }
    
    .form-section {
      background: var(--light-color);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }
    
    .form-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 20px;
      color: var(--primary-color);
      display: flex;
      align-items: center;
    }
    
    .form-title i {
      margin-right: 10px;
      color: var(--primary-color);
    }
    
    .form-row {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
    }
    
    .form-group {
      flex: 1;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 14px;
    }
    
    .form-group input, .form-group select {
      width: 100%;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      font-size: 14px;
      transition: border-color 0.3s;
    }
    
    .form-group input:focus, .form-group select:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.2);
    }
    
    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    
    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #0d0e1f;
    }
    
    .btn-danger {
      background-color: var(--danger-color);
      color: white;
      padding: 8px 12px;
      font-size: 13px;
    }
    
    .btn-danger:hover {
      background-color: #c5221f;
    }
    
    .btn-icon {
      margin-right: 8px;
    }
    
    .table-section {
      margin-top: 30px;
    }
    
    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .table-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-color);
      display: flex;
      align-items: center;
    }
    
    .table-title i {
      margin-right: 10px;
    }
    
    .search-box {
      position: relative;
      width: 250px;
    }
    
    .search-box input {
      width: 100%;
      padding: 10px 40px 10px 15px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      font-size: 14px;
    }
    
    .search-box i {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #999;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    th, td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }
    
    th {
      background-color: var(--primary-color);
      color: white;
      font-weight: 600;
      text-transform: uppercase;
      font-size: 13px;
      letter-spacing: 0.5px;
    }
    
    tr:nth-child(even) {
      background-color: var(--light-color);
    }
    
    tr:hover {
      background-color: #f1f3f9;
    }
    
    .action-buttons {
      display: flex;
      gap: 10px;
    }
    
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #666;
    }
    
    .empty-state i {
      font-size: 48px;
      margin-bottom: 15px;
      color: #ccc;
    }
    
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      border-radius: 6px;
      color: white;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
      transform: translateY(-100px);
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }
    
    .notification.success {
      background-color: var(--success-color);
    }
    
    .notification.error {
      background-color: var(--danger-color);
    }
    
    @media screen and (max-width: 768px) {
      .container {
        padding: 20px;
      }
      
      .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      
      .form-row {
        flex-direction: column;
        gap: 0;
      }
      
      .table-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }
      
      .search-box {
        width: 100%;
      }
      
      table {
        font-size: 14px;
      }
      
      th, td {
        padding: 10px;
      }
      
      .action-buttons {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h2>Manajemen Pengguna</h2>
      <div class="breadcrumb">
        <a href="index.html">Dashboard</a>
        <i class="fas fa-chevron-right"></i>
        <span>Manajemen Pengguna</span>
      </div>
    </div>
    
    <div class="form-section">
      <h3 class="form-title">
        <i class="fas fa-user-plus"></i>
        Tambah Pengguna Baru
      </h3>
      <div class="form-row">
        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" id="username" placeholder="Masukkan username" />
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" placeholder="Masukkan password" />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="role">Role</label>
          <select id="role">
            <option value="staff">Staff</option>
            <option value="admin">Admin</option>
          </select>
        </div>
        <div class="form-group">
          <label>&nbsp;</label>
          <button class="btn btn-primary" onclick="tambahUser()">
            <i class="fas fa-plus btn-icon"></i> Tambah Pengguna
          </button>
        </div>
      </div>
    </div>
    
    <div class="table-section">
      <div class="table-header">
        <h3 class="table-title">
          <i class="fas fa-users"></i>
          Daftar Pengguna
        </h3>
        <div class="search-box">
          <input type="text" id="searchInput" placeholder="Cari pengguna..." onkeyup="searchUsers()">
          <i class="fas fa-search"></i>
        </div>
      </div>
      
      <table>
        <thead>
          <tr>
            <th>No</th>
            <th>Username</th>
            <th>Role</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody id="userList"></tbody>
      </table>
      
      <div id="emptyState" class="empty-state" style="display: none;">
        <i class="fas fa-users-slash"></i>
        <p>Belum ada data pengguna</p>
      </div>
    </div>
  </div>
  
  <div id="notification" class="notification"></div>
  
  <script>
    // Cek autentikasi
    const userLogin = JSON.parse(localStorage.getItem("currentUser"));
    if (!userLogin || userLogin.role !== "admin") {
      showNotification("Hanya admin yang dapat mengakses halaman ini.", "error");
      setTimeout(() => {
        window.location.href = "index.html";
      }, 2000);
    }
    
    // Fungsi untuk menampilkan notifikasi
    function showNotification(message, type = 'success') {
      const notification = document.getElementById("notification");
      notification.textContent = message;
      notification.className = `notification ${type}`;
      notification.classList.add("show");
      
      setTimeout(() => {
        notification.classList.remove("show");
      }, 3000);
    }
    
    // Fungsi untuk memuat data pengguna
    function loadUsers() {
      const users = JSON.parse(localStorage.getItem("users")) || [];
      const tbody = document.getElementById("userList");
      const emptyState = document.getElementById("emptyState");
      
      tbody.innerHTML = "";
      
      if (users.length === 0) {
        emptyState.style.display = "block";
        return;
      }
      
      emptyState.style.display = "none";
      
      users.forEach((u, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${i + 1}</td>
          <td>${u.username}</td>
          <td>
            <span class="badge ${u.role === 'admin' ? 'badge-admin' : 'badge-staff'}">${u.role}</span>
          </td>
          <td>
            <div class="action-buttons">
              <button class="btn btn-danger" onclick="hapusUser(${i})">
                <i class="fas fa-trash-alt"></i> Hapus
              </button>
            </div>
          </td>
        `;
        tbody.appendChild(row);
      });
    }
    
    // Fungsi untuk menambah pengguna baru
    function tambahUser() {
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();
      const role = document.getElementById("role").value;
      
      if (!username || !password) {
        showNotification("Harap isi semua kolom!", "error");
        return;
      }
      
      const users = JSON.parse(localStorage.getItem("users")) || [];
      const exist = users.find(u => u.username === username);
      
      if (exist) {
        showNotification("Username sudah digunakan!", "error");
        return;
      }
      
      users.push({ username, password, role });
      localStorage.setItem("users", JSON.stringify(users));
      
      // Reset form
      document.getElementById("username").value = "";
      document.getElementById("password").value = "";
      document.getElementById("role").value = "staff";
      
      loadUsers();
      showNotification("Pengguna berhasil ditambahkan!");
    }
    
    // Fungsi untuk menghapus pengguna
    function hapusUser(index) {
      const users = JSON.parse(localStorage.getItem("users")) || [];
      const userToDelete = users[index];
      
      // Cegah penghapusan diri sendiri
      if (userLogin.username === userToDelete.username) {
        showNotification("Anda tidak dapat menghapus akun Anda sendiri!", "error");
        return;
      }
      
      if (confirm(`Yakin ingin menghapus pengguna "${userToDelete.username}"?`)) {
        users.splice(index, 1);
        localStorage.setItem("users", JSON.stringify(users));
        loadUsers();
        showNotification("Pengguna berhasil dihapus!");
      }
    }
    
    // Fungsi untuk pencarian pengguna
    function searchUsers() {
      const searchValue = document.getElementById("searchInput").value.toLowerCase();
      const rows = document.querySelectorAll("#userList tr");
      
      rows.forEach(row => {
        const username = row.cells[1].textContent.toLowerCase();
        const role = row.cells[2].textContent.toLowerCase();
        
        if (username.includes(searchValue) || role.includes(searchValue)) {
          row.style.display = "";
        } else {
          row.style.display = "none";
        }
      });
    }
    
    // Tambahkan style untuk badge
    const style = document.createElement('style');
    style.textContent = `
      .badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
      }
      
      .badge-admin {
        background-color: rgba(234, 67, 53, 0.1);
        color: var(--danger-color);
      }
      
      .badge-staff {
        background-color: rgba(66, 133, 244, 0.1);
        color: var(--accent-color);
      }
    `;
    document.head.appendChild(style);
    
    // Load data saat halaman dimuat
    loadUsers();
    
    // Event listener untuk Enter key pada form
    document.getElementById("password").addEventListener("keypress", function(e) {
      if (e.key === "Enter") {
        tambahUser();
      }
    });
  </script>
</body>
</html>